# vRain GUI版本说明

## 概述

vRain提供了两个GUI版本，分别基于不同的后端引擎：

1. **单文件模式GUI** (`vrain_gui.py`) - 基于 `vrain.py`
2. **书籍ID模式GUI** (`vrain_back_gui.py`) - 基于 `vrain_back.py`

## 文件结构

```
vRain-main/
├── vrain_gui.py          # 单文件模式GUI
├── vrain_back_gui.py     # 书籍ID模式GUI
├── run_gui.py           # 单文件模式启动脚本
├── run_back_gui.py      # 书籍ID模式启动脚本
├── run_gui.bat          # Windows单文件模式启动脚本
├── run_back_gui.bat     # Windows书籍ID模式启动脚本
├── test_back_gui.py     # GUI功能测试脚本
└── README_GUI.md        # 详细使用说明
```

## 两种模式的区别

### 单文件模式 (vrain_gui.py)
- **适用场景**: 处理单个文本文件
- **文件选择**: 手动选择文本文件和配置文件
- **输出位置**: `results/` 目录
- **特点**: 灵活性高，适合处理任意文本文件

### 书籍ID模式 (vrain_back_gui.py)
- **适用场景**: 处理books目录下的多个文本文件
- **文件选择**: 从下拉列表选择书籍ID
- **输出位置**: `books/ID/` 目录
- **特点**: 自动化程度高，适合批量处理

## 启动方法

### Windows用户
```bash
# 单文件模式
双击 run_gui.bat
# 或
python run_gui.py

# 书籍ID模式
双击 run_back_gui.bat
# 或
python run_back_gui.py
```

### macOS/Linux用户
```bash
# 单文件模式
python run_gui.py

# 书籍ID模式
python run_back_gui.py
```

## 功能特性

### 共同特性
- ✅ 图形化界面，操作简单
- ✅ 实时日志显示
- ✅ 进度反馈
- ✅ 错误处理
- ✅ 多线程处理（避免界面卡死）
- ✅ 支持PDF压缩
- ✅ 支持测试模式

### 单文件模式特有
- ✅ 文件浏览器选择
- ✅ 快速示例配置
- ✅ 章节模式支持
- ✅ 页面范围设置

### 书籍ID模式特有
- ✅ 书籍列表自动扫描
- ✅ 书籍信息显示
- ✅ 文本文件数量统计
- ✅ 快速书籍选择按钮

## 界面预览

### 单文件模式界面
```
┌─────────────────────────────────────────┐
│ vRain v1.4-GUI - 古籍刻本电子书制作工具    │
├─────────────────────────────────────────┤
│ 文件选择                                │
│ 文本文件: [浏览]                        │
│ 书籍配置: [浏览]                        │
│ 封面文件: [浏览] (可选)                  │
│ [史记示例] [神武天帝示例] [庄子示例]       │
├─────────────────────────────────────────┤
│ 页面参数                                │
│ 起始页: [1] 结束页: [0] 测试页数: [0]   │
├─────────────────────────────────────────┤
│ 选项                                    │
│ ☑ 压缩PDF  ☑ 详细输出                   │
├─────────────────────────────────────────┤
│ [生成PDF] [清空日志] [打开结果目录] [退出] │
├─────────────────────────────────────────┤
│ 处理日志                                │
│ [日志内容显示区域]                       │
└─────────────────────────────────────────┘
```

### 书籍ID模式界面
```
┌─────────────────────────────────────────┐
│ vRain v1.4-GUI-Back - 古籍刻本电子书制作工具 │
├─────────────────────────────────────────┤
│ 书籍选择                                │
│ 书籍ID: [下拉列表 ▼] [刷新书籍列表]       │
│ [史记(01)] [碧血剑(02)] [庄子(03)] [神武天帝(04)] │
├─────────────────────────────────────────┤
│ 文本参数                                │
│ 起始文本: [1] 结束文本: [1] 测试页数: [0] │
├─────────────────────────────────────────┤
│ 选项                                    │
│ ☑ 压缩PDF  ☑ 详细输出                   │
├─────────────────────────────────────────┤
│ [生成PDF] [清空日志] [打开结果目录] [打开books目录] [帮助] [退出] │
├─────────────────────────────────────────┤
│ 书籍信息                                │
│ 标题: 史记                              │
│ 作者: 司马迁                            │
│ 背景: 01_Black                          │
│ 文本文件数: 3                           │
├─────────────────────────────────────────┤
│ 处理日志                                │
│ [日志内容显示区域]                       │
└─────────────────────────────────────────┘
```

## 测试和验证

运行测试脚本检查环境：
```bash
python test_back_gui.py
```

测试内容包括：
- 依赖包检查
- 模块导入测试
- books目录检查
- GUI类创建测试

## 故障排除

### 常见问题

1. **GUI无法启动**
   - 检查Python版本（需要3.8+）
   - 检查tkinter是否可用
   - 检查依赖包是否安装

2. **模块导入错误**
   - 确保所有.py文件在同一目录
   - 检查文件编码（UTF-8）

3. **书籍列表为空**
   - 检查books目录是否存在
   - 检查books目录下的子目录命名（应为数字）

4. **PDF生成失败**
   - 检查字体文件是否存在
   - 检查配置文件格式
   - 查看日志信息

### 依赖包安装

```bash
pip install reportlab Pillow opencc-python-reimplemented
```

## 版本信息

- **GUI版本**: v1.4-GUI / v1.4-GUI-Back
- **后端版本**: v1.4 / v1.4-Python
- **界面框架**: tkinter
- **支持平台**: Windows、macOS、Linux
- **Python要求**: 3.8+

## 更新日志

### v1.4-GUI-Back
- 新增书籍ID模式GUI
- 支持自动扫描books目录
- 添加书籍信息显示
- 优化用户界面布局
- 增强错误处理和日志显示

### v1.4-GUI
- 基于vrain.py的单文件模式GUI
- 支持文件浏览器选择
- 支持章节模式
- 实时进度显示
